[tox]
envlist = docs,coverage,.python{27,30,31,32,33,34,35,36}-sqlalchemy{08,09,10,11,12}-pyyaml{301,302,303,304,305,306,307,308,309,310,311,312,42b1,42b2}-simplejson{30,31,32,33,34,35,36,37,38,39,310,311,312,313,314,315,316}

[travis]
os =
    linux: .python{27,30,31,32,33,34,35,36}-sqlalchemy{08,09,10,11,12}-pyyaml{301,302,303,304,305,306,307,308,309,310,311,312,42b1,42b2}-simplejson{30,31,32,33,34,35,36,37,38,39,310,311,312,313,314,315,316},docs,coverage
    osx: .python{27,30,31,32,33,34,35,36}-sqlalchemy{08,09,10,11,12}-pyyaml{301,302,303,304,305,306,307,308,309,310,311,312,42b1,42b2}-simplejson{30,31,32,33,34,35,36,37,38,39,310,311,312,313,314,315,316}
python =
    3.6: .python36,docs,coverage

[testenv]
usedevelop = True
description =
    .python{27,30,31,32,33,34,35,36}: Run unit tests against {envname}.
passenv = TOXENV CI TRAVIS TRAVIS_*
deps =
    validator-collection
    sqlalchemy08: sqlalchemy>=0.8,<0.9
    sqlalchemy09: sqlalchemy>=0.9,<1.0
    sqlalchemy10: sqlalchemy>=1.0,<1.1
    sqlalchemy11: sqlalchemy>=1.1,<1.2
    sqlalchemy12: sqlalchemy>=1.2
    pyyaml301: PyYAML==3.01
    pyyaml302: PyYAML==3.02
    pyyaml303: PyYAML==3.03
    pyyaml304: PyYAML==3.04
    pyyaml305: PyYAML==3.05
    pyyaml306: PyYAML==3.06
    pyyaml307: PyYAML==3.07
    pyyaml308: PyYAML==3.08
    pyyaml309: PyYAML==3.09
    pyyaml310: PyYAML==3.10
    pyyaml311: PyYAML==3.11
    pyyaml312: PyYAML==3.12
    pyyaml42b1: PyYAML==4.2b1
    pyyaml42b2: PyYAML==4.2b2
    simplejson30: simplejson>=3.0,<3.1
    simplejson31: simplejson>=3.1,<3.2
    simplejson32: simplejson>=3.2,<3.3
    simplejson33: simplejson>=3.3,<3.4
    simplejson34: simplejson>=3.4,<3.5
    simplejson35: simplejson>=3.5,<3.6
    simplejson36: simplejson>=3.6,<3.7
    simplejson37: simplejson>=3.7,<3.8
    simplejson38: simplejson>=3.8,<3.9
    simplejson39: simplejson>=3.9,<3.10
    simplejson310: simplejson>=3.10,<3.11
    simplejson311: simplejson>=3.11,<3.12
    simplejson312: simplejson>=3.12,<3.13
    simplejson313: simplejson>=3.13,<3.14
    simplejson314: simplejson>=3.14,<3.15
    simplejson315: simplejson>=3.15,<3.16
    simplejson316: simplejson>=3.16
commands =
    pytest {posargs}
    codecov -e TOXENV

[travis:env]
SQLALCHEMY =
    0.8: sqlalchemy08
    0.9: sqlalchemy09
    1.0: sqlalchemy10
    1.1: sqlalchemy11
    1.2: sqlalchemy12,docs,coverage
PYYAML =
    3.01: pyyaml301
    3.02: pyyaml302
    3.03: pyyaml303
    3.04: pyyaml304
    3.05: pyyaml305
    3.06: pyyaml306
    3.07: pyyaml307
    3.08: pyyaml308
    3.09: pyyaml309
    3.10: pyyaml310
    3.11: pyyaml311
    3.12: pyyaml312,docs,coverage
    4.2b1: pyyaml42b1
    4.2b2: pyyaml42b2
SIMPLEJSON =
    3.0: simplejson30
    3.1: simplejson31
    3.2: simplejson32
    3.3: simplejson33
    3.4: simplejson34
    3.5: simplejson35
    3.6: simplejson36
    3.7: simplejson37
    3.8: simplejson38
    3.9: simplejson39
    3.10: simplejson310
    3.11: simplejson311
    3.12: simplejson312
    3.13: simplejson313
    3.14: simplejson314
    3.15: simplejson315
    3.16: simplejson316,docs,coverage


[testenv:pylint]
description =
    Run source code analyzer.
deps =
    pylint
    {[testenv]deps}
commands =
    pylint --rcfile {toxinidir}/.pylintrc sqlathanor

[testenv:coverage]
description =
    Run code coverage checks.
setenv =
    PYTEST_ADDOPTS = --cov ./sqlathanor --cov-config {toxinidir}/setup.cfg
deps =
    pytest-cov
    coverage
    codecov
    {[testenv]deps}
commands =
    {[testenv]commands}
    coverage report

[testenv:docs]
description =
    Build documentation.
basepython = python
changedir = docs
deps =
    sphinx
    sphinx_rtd_theme
    sphinx_tabs
commands =
    sphinx-build -nT -b dummy . _build/html
